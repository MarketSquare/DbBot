#!/usr/bin/env python

import sys
import os

sys.path.append(os.path.abspath(__file__ + '/../../'))
from topfail import DatabaseReader, HtmlWriter, WriterOptions


class TopFail(object):

    def __init__(self):
        self._options = WriterOptions()
        self._db = DatabaseReader(self._options.db_file_path)
        self._writer = HtmlWriter(self._db, self._options.output_file_path)

    def run(self):
        try:
            self._writer.write()
        finally:
            self._db.close()


if __name__ == '__main__':
    TopFail().run()
